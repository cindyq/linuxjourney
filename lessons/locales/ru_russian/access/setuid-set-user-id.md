# Setuid

## Содержание урока

Есть много случаев, когда обычные пользователи нуждаются в повышенном доступе, чтобы делать вещи. Системный администратор не может всегда быть там, чтобы вводить пароль root каждый раз, когда пользователю нужен доступ к защищенному файлу, поэтому для этого допускаются специальные биты разрешения файла. Set User ID (SUID) позволяет пользователю запускать программу как владелец файла программы, а не как они сами.

Давайте рассмотрим пример: 

Скажем, я хочу изменить свой пароль, просто так? Я просто использую команду passwd:

<pre>$ passwd</pre>

Что делает команда пароля? Он изменяет несколько файлов, но самое главное, что он изменяет файл /etc/shadow. Давайте посмотрим на этот файл:

<pre>$ ls -l /etc/shadow

-rw-r----- 1 root shadow 1134 Dec 1 11:45 /etc/shadow
</pre>

Ой, подождите, этот файл принадлежит root? Как возможно, что мы можем изменить файл, принадлежащий пользователю root? 

Давайте посмотрим на другой набор разрешений, на этот раз выполненной нами команды: 

<pre>$ ls -l /usr/bin/passwd

-rwsr-xr-x 1 root root 47032 Dec 1 11:45 /usr/bin/passwd
</pre>

Вы увидите новый бит разрешения здесь <b>s</b>. Этот бит разрешения - SUID, когда файл имеет этот набор разрешений, он позволяет пользователям, запустившим программу, получить разрешение владельца файла, а также разрешение на выполнение, в данном случае - root. Поэтому, когда пользователь выполняет команду password, он работает от имени root.

Вот почему мы можем получить доступ к защищенному файлу, например /etc/shadow, когда запускаем команду passwd. Теперь, если вы удалили этот бит, вы увидите, что вы не сможете изменить /etc/shadow и, следовательно, изменить свой пароль.

<b>Изменение SUID</b>

Как и обычные разрешения, есть два способа изменения SUID-прав. 

<i>Символический способ:</i>
<pre>$ sudo chmod u+s myfile</pre>

<i>Численный путь:</i>
<pre> sudo chmod 4755 myfile</pre>

Как вы можете видеть, SUID обозначается цифрой 4 и предварительно помещается в набор разрешений. Вы можете увидеть, что SUID обозначается как <b>S</b>, это означает, что он все еще делает то же самое, но у него нет прав на выполнение.

## Задание

Посмотрите на разрешение для /etc/passwd подробно, замечаете ли вы что-нибудь еще? Файлы с включенным SUID также легко различимы.

## Вопрос

Какой номер представляет собой SUID?

## Ответ

4
