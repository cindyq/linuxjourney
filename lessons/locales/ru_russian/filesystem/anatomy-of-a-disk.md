# Анатомия диска

## Содержание урока

Жесткие диски могут быть подразделены на разделы, в основном создавая несколько блочных устройств. Вспомните такие примеры, как /dev/sda1 и /dev/sda2, /dev/sda - весь диск, но /dev/sda1 - это первый раздел на этом диске. Разделы чрезвычайно полезны для разделения данных, и если вам нужна определенная файловая система, вы можете легко создать раздел вместо того, чтобы сделать весь диск одним типом файловой системы.

<b>Таблица разделов</b>

Каждый диск будет иметь таблицу разделов, эта таблица сообщает системе, как диск разделен. В этой таблице указывается, где разделы начинаются и заканчиваются, какие разделы являются загрузочными, какие секторы диска распределены для какого раздела и т.д. Существуют две основные схемы таблиц разделов: основная загрузочная запись (MBR) и таблица разделов GUID (GPT).

<b>Раздел</b>

Диски состоят из разделов, которые помогают нам организовывать наши данные. Вы можете иметь несколько разделов на диске, и они не могут перекрывать друг друга. Если есть пространство, которое не назначено разделу, то оно называется свободным пространством. Типы разделов зависят от вашей таблицы разделов. Внутри раздела вы можете иметь файловую систему или выделить раздел для других вещей, таких как свопинг.

<i>MBR</i>

<ul>
<li>Традиционная таблица разделов была использована в качестве стандарта</li>
<li>Может иметь первичные, расширенные и логические разделы</li>
<li>MBR имеет ограничение на четыре основных раздела</li>
<li>Дополнительные разделы можно сделать, создав основной раздел в расширенный раздел (на диске может быть только один расширенный раздел). Затем внутри расширенного раздела вы добавляете логические разделы. Логические разделы используются так же, как и любой другой раздел. Глупо, я знаю.</li> 
<li>Поддерживает диски до 2 терабайт</li>
</ul>

<i>GPT</i>

<ul>
<li>Таблица разделов GUID (GPT) становится новым стандартом для разделения дисков</li>
<li>Имеет только один тип раздела, и вы можете сделать многие из них</li>
<li>Каждый раздел имеет глобально уникальный идентификатор (GUID)</li>
<li>Используется в основном в сочетании с загрузкой на основе UEFI (мы подробно рассмотрим в другом курсе)</li> 
</ul>

<b>Структура файловой системы</b>

На нашем предыдущем уроке мы узнали, что файловая система представляет собой организованную коллекцию файлов и каталогов. В своей простейшей форме он состоит из базы данных для управления файлами и самими фактическими файлами, однако мы рассмотрим немного более подробно.

<ul>
<li>Boot block (Блок загрузки) расположен в первых нескольких секторах файловой системы, и он не используется файловой системой. Скорее, он содержит информацию, используемую для загрузки операционной системы. Операционная система требует только один загрузочный блок. Если у вас несколько разделов, у них будут загрузочными блоками, но многие из них не используются.</li>
<li>Супер блок - это один блок, который приходит после загрузочного блока, и содержит информацию о файловой системе, такую как размер таблицы inode, размер логических блоков и размер файловой системы.</li>
<li>Таблица inode - база данных, которая управляет нашими файлами (у нас есть целый урок на inodes, так что не беспокойтесь). Каждый файл или каталог имеет уникальную запись в таблице inode и имеет различную информацию о файле.</li>
<li>Блоки данных - это фактические данные для файлов и каталогов.</li>
</ul>
 
Давайте рассмотрим различные таблицы разделов. Ниже приведен пример раздела с использованием таблицы разбиения MBR (msdos). Вы можете видеть основные, расширенные и логические разделы на машине.

<pre>
pete@icebox:~$ sudo parted -l
Model: Seagate (scsi)
Disk /dev/sda: 21.5GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos

Number  Start   End     Size    Type      File system     Flags
 1      1049kB  6860MB  6859MB  primary   ext4            boot
 2      6861MB  21.5GB  14.6GB  extended
 5      6861MB  7380MB  519MB   logical   linux-swap(v1)
 6      7381MB  21.5GB  14.1GB  logical   xfs
</pre>


В этом примере используется GPT, используя только уникальный идентификатор для разделов.

<pre>
Model: Thumb Drive (scsi)
Disk /dev/sdb: 4041MB
Sector size (logical/physical): 512B/512B
Partition Table: gpt

Number  Start   End     Size     File system  Name        Flags
 1      17.4kB  1000MB  1000MB                first
 2      1000MB  4040MB  3040MB                second
</pre>

## Задание

Запустите <b>parted -l</b> на вашем компьютере и оцените свои результаты.

## Вопрос

Какой тип раздела используется для создания более 4 разделов в схеме разделения MBR?

## Ответ

extended
