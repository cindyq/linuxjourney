# symlinks

## Содержание урока

Давайте используем предыдущий пример информации об inode:

<pre>
pete@icebox:~$ ls -li
140 drwxr-xr-x 2 pete pete 6 Jan 20 20:13 Desktop
141 drwxr-xr-x 2 pete pete 6 Jan 20 20:01 Documents
</pre>

Возможно, вы заметили, что мы замаскировали третье поле в команде ls, это поле является числом ссылок. Счетчик ссылок - это общее количество жестких ссылок, которые имеет файл, ну это ничего не значит для вас прямо сейчас. Итак, давайте сначала обсудим ссылки.

<b>Symlinks</b>

В операционной системе Windows есть вещи, называемые ярлыками, ярлыки - это просто псевдонимы для других файлов. Если вы сделаете что-то в исходном файле, вы можете разбить ярлык. В Linux эквивалент ярлыков - это символические ссылки (или софт-ссылки или символические ссылки). Symlinks позволяют нам ссылаться на другой файл по имени файла. Другим типом ссылок, найденных в Linux, являются hardlinks, это фактически другой файл со ссылкой на индексный дескриптор. Посмотрим, что я имею в виду на практике, начиная с символических ссылок.

<pre>
pete@icebox:~/Desktop$ echo 'myfile' > myfile
pete@icebox:~/Desktop$ echo 'myfile2' > myfile2
pete@icebox:~/Desktop$ echo 'myfile3' > myfile3

pete@icebox:~/Desktop$ ln -s myfile myfilelink
pete@icebox:~/Desktop$ ls -li
total 12
  151 -rw-rw-r-- 1 pete pete 7 Jan 21 21:36 myfile
93401 -rw-rw-r-- 1 pete pete 8 Jan 21 21:36 myfile2
93402 -rw-rw-r-- 1 pete pete 8 Jan 21 21:36 myfile3
93403 lrwxrwxrwx 1 pete pete 6 Jan 21 21:39 myfilelink -> myfile
</pre>

Вы видите, что я создал символическую ссылку myfilelink, которая указывает на myfile. Символьные ссылки обозначаются ->. Заметьте, как я получил новый номер inode, хотя символические ссылки - это просто файлы, которые указывают на имена файлов. При изменении символической ссылки файл также изменяется. Номера Inode уникальны для файловых систем, вы не можете иметь два одинаковых номера inode в одной файловой системе, то есть вы не можете ссылаться на файл в другой файловой системе по номеру inode. Однако, если вы используете символические ссылки, они не используют номера inode, они используют имена файлов, поэтому они могут ссылаться на разные файловые системы. 

<b>Hardlinks</b>

Давайте посмотрим пример жесткой ссылки:

<pre>
pete@icebox:~/Desktop$ ln myfile2 myhardlink
pete@icebox:~/Desktop$ ls -li
total 16
  151 -rw-rw-r-- 1 pete pete 7 Jan 21 21:36 myfile
93401 -rw-rw-r-- 2 pete pete 8 Jan 21 21:36 myfile2
93402 -rw-rw-r-- 1 pete pete 8 Jan 21 21:36 myfile3
93403 lrwxrwxrwx 1 pete pete 6 Jan 21 21:39 myfilelink -> myfile
93401 -rw-rw-r-- 2 pete pete 8 Jan 21 21:36 myhardlink
</pre>

Жесткая ссылка просто создает другой файл со ссылкой на тот же индекс. Поэтому, если я изменил содержимое myfile2 или myhardlink, изменение будет видно на обоих, но если бы я удалил myfile2, файл все равно был бы доступен через myhardlink. Здесь наш счетчик ссылок в команде ls вступает в игру. Счетчик ссылок - это количество жестких ссылок, которое имеет индекс inode, когда вы удаляете файл, это уменьшит количество ссылок. Индекс удаляется только после удаления всех жестких ссылок на индекс. Когда вы создаете файл, его количество ссылок равно 1, потому что это единственный файл, указывающий на этот индекс. В отличие от символических ссылок, hardlinks не охватывает файловые системы, потому что inodes уникальны для файловой системы. 

<b>Создание символической ссылки</b>

<pre>
$ ln -s myfile mylink</pre>

Чтобы создать символическую ссылку, вы используете команду ln с -s для символа, и вы задаете целевой файл, а затем имя ссылки. 

<b>Создание жесткой ссылки</b>

<pre>
$ ln somefile somelink</pre>

Подобно созданию символической ссылки, за исключением того, что вы не учитываете -s.

## Задание

Попробуйте создать символические и жесткие ссылки потом удалите пару и посмотрите, что произойдет.

## Вопрос

Какая команда используется для создания символической ссылки?

## Ответ

ln -s
