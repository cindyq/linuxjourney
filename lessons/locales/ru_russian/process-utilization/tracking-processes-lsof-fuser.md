# lsof и fuser

## Содержание урока

Допустим, вы подключили USB-накопитель и начали работать с некоторыми файлами, как только вы закончили, вы отключили USB-устройство, и получили сообщение об ошибке «Device или Resource Busy». Как вы узнали, какие файлы на USB-накопителе все еще используются? На самом деле есть два инструмента, которые вы можете использовать для этого:

<b>lsof</b>

Помните, что файлы - это не только текст, изображения и т.д. Это так же все остальное: диски, каналы, сетевые сокеты, устройства и т. Д. Чтобы увидеть, что используется процессом, вы можете использовать команду lsof «Список открытых файлов»), это покажет вам список всех открытых файлов и связанного с ними процесса. 

<pre>
pete@icebox:~$ lsof .
COMMAND    PID  USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
lxsession 1491 pete  cwd    DIR    8,6     4096  131 .
update-no 1796 pete  cwd    DIR    8,6     4096  131 .
nm-applet 1804 pete  cwd    DIR    8,6     4096  131 .
indicator 1809 pete  cwd    DIR    8,6     4096  131 .
xterm     2205 pete  cwd    DIR    8,6     4096  131 .
bash      2207 pete  cwd    DIR    8,6     4096  131 .
lsof      5914 pete  cwd    DIR    8,6     4096  131 .
lsof      5915 pete  cwd    DIR    8,6     4096  131 .
</pre>

Теперь я вижу, какие процессы в настоящее время хранят device/file открытыми. В нашем примере USB вы также можете убить эти процессы, чтобы мы могли отключить этот досадный диск.

<b>fuser</b>

Другим способом отслеживания процесса является команда fuser (сокращение от «файла пользователя»), это покажет вам информацию о процессе, который использует файл или пользователь файла.

<pre>
pete@icebox:~$ fuser -v .
                     USER        PID ACCESS COMMAND
/home/pete:         pete  1491 ..c.. lxsession
                     pete  1796 ..c.. update-notifier
                     pete  1804 ..c.. nm-applet
                     pete  1809 ..c.. indicator-power
                     pete  2205 ..c.. xterm
                     pete  2207 ..c.. bash
</pre>

Мы можем видеть, какие процессы в настоящее время используют наш каталог /home/pete. Инструменты lsof и fuser очень похожи, ознакомьтесь с этими инструментами и попробуйте использовать их в следующий раз, когда вам нужно отслеживать файл или процесс.

## Задание

Прочтите man-страницы для lsof и fuser, там есть много информации, которую мы не рассматривали, что позволяет вам иметь большую гибкость с этими инструментами.

## Вопрос

Какая команда используется для отображения открытых файлов и их информации о процессе?

## Ответ

lsof