# فرآیند بوت: کرنل

## محتوای درس

حال که bootloader، پارامتر‌های لازم را ارائه کرده، بیایید ببینیم که کرنل چگونه شروع به کار می‌کند:

**‏Initrd vs Initramfs**

وقتی که در خصوص کرنل صحبت می‌کنیم‌، قضیه تا حدی به قضیهٔ مرغ و تخم مرغ شباهت دارد.
کرنل وظیفه مدیریت سخت‌افزار سیستم ما را بر عهده دارد، با این حال‌، همهٔ این
سخت‌افزار‌ها در هنگام بارگذاری کرنل‌، در دسترس‌اش قرار ندارند. پس ما به یک فایل
سیستم root موقت وابسته‌ایم که ماژول‌های مورد نیاز کرنل را برای شناسایی باقی
سخت‌افزار‌ها فراهم می‌کند. در نسخه‌های قدیمی‌تر لینوکس‌، این وظیفه بر عهدهٔ initrd‎ یا
همان Ram disk اولیه‌، قرار داشت. کرنل، initrd را سوار (mount) می‌کرد، و پس از
بارگذاری موارد مورد نیاز بوت و درایور‌های لازم‌، initrd را با فایل سیستم root
اصلی‌، جایگزین می‌کرد. امروزه‌، ما چیز دیگری به اسم initramfs داریم که شامل فایل
سیستم روت موقتی است که درون خود کرنل قرار داده شده تا تمامی درایور‌های حیاتی برای
فایل سیستم root اصلی را بارگذاری کند، تا دیگر نیازی به جایگزینی فایل initrd
نباشد.

در حقیقت‌، اگر از یک کرنل مدرن استفاده می‌کنید‌، می‌توانید پارامتر initrd را از
bootloader حذف کنید‌، و همچنان بدون مشکل سیستم را بوت کنید. (نکته: بهتر است به
جای پاک کردن پارامتر‌، خط مربوطه‌اش را کامنت کنید، تا وقتی سیستم‌تان به مشکل بر
خورد‌، به راحتی این مقدار را باز گردانید.)

**سوار کردن فایل سیستم root**

حالا کرنل‌، تمامی ماژول‌های مورد نیاز جهت ساخت یک دیوایس root و سوار کردن پارتیشن
root را در دسترس دارد. قبل از پیش‌روی بیشتر‌، پارتیشن root‌، در حقیقت به صورت فقط
خواندنی (read-only) سوار شده تا `fsck` بتواند در امنیت کامل فایل سیستم را بررسی
کند. سپس فایل سیستم root مجدد با قابلیت خواندن و نوشتن سوار می‌شود. سرانجام کرنل
برنامهٔ init را پیدا کرده و آن را اجرا می‌کند.

## تمرینات

بدون تمرین

## سوالات آزمون

در کرنل‌های مدرن از چه مکانیزمی جهت بارگذاری فایل سیستم موقت استفاده شده است؟

## پاسخ آزمون

initramfs
